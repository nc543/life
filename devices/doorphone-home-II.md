# 第二代

## SY-333

```
    ┌───┐ ┌────┐
110─┤ EL├─┤電鎖│
VAC─┤ AC├─┤    │
    │   │ └────┘
    │   │ ┌────┐
    │ RD├─┤門口│
    │ TD├─┤機  │
    │   │ └────┘     網路
    │   │         ┌───┴─┐
    │Rph├─各層樓  │xDSL │
    │Tph├─話機    │modem│
    │   │         └───┬┬┘
    │   │       ┌─────┴┴┐
    │ L2├───────┤spliter├─局
    │ L1├───────┤       ├─線
    └───┘       └───────┘
```
電源
* 110VAC 經過變壓器為 62VAC 作為振鈴源
* 62VAC 經過整流為 41VDC 作為門鎖電壓及門口機電路使用
* 41VDC 在轉成 15VDC 及 5VDC
```
_______  __  __  ______        ┌────┐41VDC
110VAC WW  )(  WW 62VAC  \─┬───┤整流├─┬────>門鎖電壓
       5Ω  )(__  1KΩ       │   └────┘ ├>15V->5V
           )(
___________)(____振鈴源             └>門口機電路
```
外線 L1/L2
* photodiode 隔離響鈴偵測 => RA0
* 平常跟內線搭在一起，按下門口機按鍵分離。(RB5 控制的繼電器)

內線 Rph/Tph
* 電容及變壓器隔離
	* HM9270D DTMF 偵測
	* RB7
* 橋式整流
	* hook detection => RB6
	* ??
* 平常搭到內線，按下門口機按鍵改搭到另一個 RB4 控制的繼電器。(RB5 控制的繼電器) 內線沒振鈴時搭到門口機電路及 RB7。
門口機 RD/TD
* 平常 4.8V，按 0V，放 12V

門鎖 EL/AC
* 可提供 41VDC 或只是讓迴路接通

PIC16F54
* RA0：偵測外線響鈴
* RA1：偵測 * (1011) 或 # (1100)
* RA2：門口機響鈴中
* RA3：(門口機電路)
* RB0：偵測門口機按鍵
* RB1：(門口機電路)
* RB2：
* RB3：控制開門鎖繼電器
* RB4：控制響鈴繼電器
* RB5：控制外線繼電器。平常為 0 = 搭到內線。
* RB6：偵測 offhook
* RB7：輸出音樂？可能是輸出插撥音

```
idle --(門口按鍵)-> 門口響鈴 -(offhook)-> 門口通話
     <-(timeout)---
     <------------------------(onhook)---

門口通話

idle --(offhook)-> 外線通話或撥出
     <-(onhook)---

門口通話 -(外線來電)-> 插撥音

外線通話或撥出 -(門口按鍵來電)-> 插撥音
```
offhook -(門口按鍵)-> 插撥音？

同時外線來電及門口按鍵？

插撥音外線或門口會聽到？

未來
* 一樓蜂鳴器，需要 24VAC 驅動？用 15VDC 可以嗎？
* 局端電源
* 樓層互打
* 轉網路電話、line 電話、FB 電話
* 擴音


* UY 2P K2電話接線壓接端子
* UR 3P 電話接線壓接端子
* UB 2P 電話分接線壓接端子
* 電話線接頭 壓線鉗
